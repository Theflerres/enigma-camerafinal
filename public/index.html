<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>O FIM</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: black;
      color: white;
      font-family: 'Courier New', Courier, monospace;
      overflow-y: auto;
      overflow-x: hidden; /* Prevenir scroll horizontal com overlays */
    }

    #container, #fase2, #fase3, #senhaFinal, #fim, .fullscreen-sequence { /* Adicionado .fullscreen-sequence */
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      text-align: center;
      padding: 20px;
      box-sizing: border-box; /* Para que padding não aumente o tamanho total */
    }

    #container {
      display: flex;
    }

    input[type="text"], input[type="password"] { 
      padding: 10px;
      font-size: 20px;
      margin-top: 10px; 
      background: black;
      color: red; 
      border: 2px solid red; 
      font-family: 'Courier New', Courier, monospace;
      box-sizing: border-box;
    }

    #fase2 input, #senhaFinal input, #loginSection input, 
    #convidadoNomeInput, /* Estilo para novo input */
    .fake-login-input /* Estilo para inputs do login falso */
    { 
      color: lime;
      border-color: lime;
    }
    #loginSection input {
        margin-bottom: 15px;
    }
    #convidadoNomeInput, .fake-login-input {
        margin-bottom: 15px;
        width: 80%;
        max-width: 300px;
    }


    iframe {
      width: 80vw;
      height: 45vw;
      max-width: 800px;
      max-height: 450px;
      border: none;
      margin-top: 20px;
    }

    #aviso, #timer, #painel, #poemaFinal {
      color: lime;
      font-family: 'Courier New', monospace;
      font-size: 20px;
      text-align: center;
      margin-top: 20px;
    }

    #painel, #poemaFinal {
      font-size: 18px;
      white-space: pre-wrap;
      padding: 10px;
      width: 80%;
      max-width: 800px;
      margin: 0 auto;
      word-break: break-all;
    }

    .digitando::after {
      content: '|';
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      50% { opacity: 0; }
    }

    #videoFull {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 9999;
      background-color: black;
    }

    #videoFull video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    #fim {
      position: relative;
    }

    #hiddenMessage {
      position: absolute;
      bottom: 10px;
      right: 10px;
      font-size: 10px;
      color: #0A0A0A;
      z-index: 1;
      text-align: right;
    }

    #loginSection {
      margin-top: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #submitLoginButton, #repeatAudioButton, .fake-submit-button { /* Adicionado .fake-submit-button */
      padding: 10px 20px;
      background-color: lime;
      color: black;
      border: none;
      font-family: 'Courier New', Courier, monospace;
      font-size: 18px;
      cursor: pointer;
      margin-top: 10px;
    }
    #submitLoginButton:hover, #repeatAudioButton:hover, .fake-submit-button:hover { 
        background-color: #00e600; 
    }
    #repeatAudioButton {
        margin-top: 20px; 
    }
    
    /* Estilos para a sequência CameraMan */
    .fullscreen-sequence {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background-color: black;
        z-index: 1000; /* Acima do conteúdo normal */
    }
    .fullscreen-sequence img {
        max-width: 80%;
        max-height: 60vh;
        margin-bottom: 20px;
        border: 2px solid lime;
    }
     .fullscreen-sequence h1.typing-effect { /* Para "Acessando biblioteca..." */
        font-size: 2.5em; /* Ajuste conforme necessário */
        color: lime;
        padding: 20px;
     }

    #unauthorizedOverlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background-color: rgba(0,0,0,0.9);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 100000; /* Acima de tudo */
        text-align: center;
    }
    #unauthorizedOverlay h1 {
        color: red;
        font-size: 3em; /* Bem grande */
        padding: 20px;
        text-shadow: 2px 2px 4px black;
    }

  </style>
</head>
<body>

  <div id="container">
    <h1>Quem é ele, o guardião da informação, que tudo observa, em silêncio agudo?</h1>
    <p>Qual o "nome real" dele?</p>
    <input type="text" id="senha" placeholder="Digite a senha...">
  </div>

  <div id="videoFull" style="display:none;">
    <video id="introVideo" controls>
      <source src="HH.mp4" type="video/mp4">
    </video>
  </div>

  <div id="fase2">
    <h2>Essa pessoa com quem ele conversa é diferente mas igual a ele,<br>mesmo rosto mas um nome diferente, me pergunto o nome dele...</h2>
    <iframe src="https://www.youtube.com/embed/VFZtzloiOV0" allowfullscreen></iframe>
    <input type="text" id="segunda-senha" placeholder="Digite o nome dele...">
  </div>

  <div id="fase3">
    <div id="aviso"></div>
    <div id="timer"></div>
    <div id="painel"></div>
  </div>

  <div id="senhaFinal">
    <input type="text" id="finalInput" placeholder="Digite a senha final...">
  </div>

  <div id="fim">
    <div id="poemaFinal" class="digitando"></div>
    <div id="hiddenMessage">Por favor, utilize o drive para descriptografar</div>
    
    <div id="loginSection" style="display: none;">
        <input type="text" id="loginInput" placeholder="Login...">
        <input type="password" id="passwordInput" placeholder="Senha...">
        <button id="submitLoginButton">Entrar</button>
    </div>
    <audio id="finalAudio" src="bemvindo.wav" preload="auto"></audio>
    <button id="repeatAudioButton" style="display: none;">Repetir Áudio</button> 
  </div>

  <script>
    const senhaInput = document.getElementById("senha");
    const segundaSenhaInput = document.getElementById("segunda-senha");
    const finalInput = document.getElementById("finalInput");
    const container = document.getElementById("container");
    const fase2 = document.getElementById("fase2");
    const fase3 = document.getElementById("fase3");
    const senhaFinal = document.getElementById("senhaFinal");
    const timerEl = document.getElementById("timer");
    const painel = document.getElementById("painel");
    const videoFull = document.getElementById("videoFull");
    const introVideo = document.getElementById("introVideo");
    const fimDiv = document.getElementById("fim");
    const poemaFinal = document.getElementById("poemaFinal");
    const avisoEl = document.getElementById("aviso");
    const hiddenMessageEl = document.getElementById("hiddenMessage"); 

    const loginSection = document.getElementById("loginSection");
    const loginInput = document.getElementById("loginInput");
    const passwordInput = document.getElementById("passwordInput");
    const submitLoginButton = document.getElementById("submitLoginButton");
    const finalAudio = document.getElementById("finalAudio");
    const repeatAudioButton = document.getElementById("repeatAudioButton"); 


    // --- INÍCIO FUNÇÕES SEQUÊNCIA CAMERAMAN ---

    function typeWriterEffect(element, text, callback, speed = 100) {
        let i = 0;
        element.innerHTML = ""; // Limpa o elemento
        element.classList.add("digitando"); 
        function type() {
            if (i < text.length) {
                element.innerHTML += text.charAt(i);
                i++;
                setTimeout(type, speed);
            } else {
                element.classList.remove("digitando");
                if (callback) setTimeout(callback, 500); // Pequeno delay antes do callback
            }
        }
        type();
    }

    function triggerShutdownSequence() {
        // Remove outras sequências fullscreen se existirem
        const existingCameraManSeq = document.getElementById("cameraManSequenceDiv");
        if (existingCameraManSeq) existingCameraManSeq.remove();
        const existingFcnAccess = document.getElementById("fcnAccessScreenDiv");
        if (existingFcnAccess) existingFcnAccess.remove();


        let overlay = document.getElementById('unauthorizedOverlay');
        if (!overlay) {
            overlay = document.createElement('div');
            overlay.id = 'unauthorizedOverlay';
            document.body.appendChild(overlay); // Estilos já definidos no CSS
        }
        overlay.style.display = 'flex';
        
        const unauthorizedMessage = document.createElement('h1');
        unauthorizedMessage.textContent = "ACESSO NÃO AUTORIZADO DETECTADO";
        overlay.innerHTML = ''; 
        overlay.appendChild(unauthorizedMessage);
        
        setTimeout(() => {
            // Tenta fechar a janela/aba. Pode não funcionar em todos os cenários.
            unauthorizedMessage.innerHTML += "<br><br>INICIANDO PROTOCOLO DE ENCERRAMENTO...";
            setTimeout(() => {
                window.open('', '_self', ''); // Necessário em alguns navegadores para permitir o close
                window.close();
                // Fallback se window.close() falhar:
                if (!document.hidden) { // Se a aba ainda estiver visível
                    unauthorizedMessage.innerHTML += "<br><br>FALHA NO ENCERRAMENTO AUTOMÁTICO.<br>POR FAVOR, FECHE ESTA ABA MANUALMENTE.";
                }
            }, 2000);
        }, 2000); 
    }

    function showFakeLogin(parentElement) {
        parentElement.innerHTML = ''; // Limpa o texto "Acessando..."

        const fakeLoginPrompt = document.createElement('p');
        fakeLoginPrompt.textContent = "Autenticação da Biblioteca FCN Requerida:";
        fakeLoginPrompt.style.color = "lime";
        fakeLoginPrompt.style.fontSize = "1.5em";
        fakeLoginPrompt.style.marginBottom = "20px";
        parentElement.appendChild(fakeLoginPrompt);

        const fakeLoginInputEl = document.createElement('input');
        fakeLoginInputEl.type = 'text';
        fakeLoginInputEl.placeholder = 'ID de Agente FCN...';
        fakeLoginInputEl.className = 'fake-login-input'; // Para estilo CSS
        parentElement.appendChild(fakeLoginInputEl);

        const fakePasswordInputEl = document.createElement('input');
        fakePasswordInputEl.type = 'password';
        fakePasswordInputEl.placeholder = 'Senha de Acesso FCN...';
        fakePasswordInputEl.className = 'fake-login-input'; // Para estilo CSS
        parentElement.appendChild(fakePasswordInputEl);
        
        const fakeSubmitButtonEl = document.createElement('button');
        fakeSubmitButtonEl.textContent = 'Verificar Credenciais';
        fakeSubmitButtonEl.className = 'fake-submit-button'; // Para estilo CSS
        parentElement.appendChild(fakeSubmitButtonEl);

        fakeLoginInputEl.focus();

        function onFakeSubmitAttempt() {
            // Independente da resposta, aciona o shutdown
            triggerShutdownSequence();
        }

        fakeSubmitButtonEl.addEventListener('click', onFakeSubmitAttempt);
        fakePasswordInputEl.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                onFakeSubmitAttempt();
            }
        });
         fakeLoginInputEl.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                fakePasswordInputEl.focus();
            }
        });
    }

    function showFcnAccessScreen() {
        const existingCameraManSeq = document.getElementById("cameraManSequenceDiv");
        if (existingCameraManSeq) existingCameraManSeq.remove();

        let fcnScreen = document.getElementById('fcnAccessScreenDiv');
        if (!fcnScreen) {
            fcnScreen = document.createElement('div');
            fcnScreen.id = 'fcnAccessScreenDiv';
            fcnScreen.className = 'fullscreen-sequence'; // Aplica estilo CSS
            document.body.appendChild(fcnScreen);
        }
        fcnScreen.innerHTML = ''; 
        fcnScreen.style.display = 'flex';
        
        const typingTextElement = document.createElement('h1');
        typingTextElement.className = 'typing-effect'; // Para estilo CSS
        fcnScreen.appendChild(typingTextElement);
        
        typeWriterEffect(typingTextElement, "Acessando biblioteca do FCN....", () => {
            showFakeLogin(fcnScreen);
        }, 120); // Velocidade de digitação
    }


    function handleCameraManPath() {
        container.style.display = 'none'; // Esconde o container original do enigma 1
        // Oculta outras fases principais se estiverem visíveis
        fase2.style.display = 'none';
        fase3.style.display = 'none';
        senhaFinal.style.display = 'none';
        fimDiv.style.display = 'none';


        let cameraManSeqDiv = document.getElementById("cameraManSequenceDiv");
        if (!cameraManSeqDiv) {
            cameraManSeqDiv = document.createElement("div");
            cameraManSeqDiv.id = "cameraManSequenceDiv";
            cameraManSeqDiv.className = "fullscreen-sequence"; // Aplica estilo CSS
            document.body.appendChild(cameraManSeqDiv);
        }
        cameraManSeqDiv.innerHTML = ''; // Limpa conteúdo anterior
        cameraManSeqDiv.style.display = 'flex';


        const img = document.createElement('img');
        img.src = 'peluche.png'; // CERTIFIQUE-SE QUE ESTA IMAGEM EXISTE NA PASTA
        img.alt = 'Peluche Secreto';
        // Estilos para imagem já no CSS via .fullscreen-sequence img
        cameraManSeqDiv.appendChild(img);
        
        const pConvidado = document.createElement('p');
        pConvidado.textContent = 'Um convidado inesperado... Qual o nome dele?';
        pConvidado.style.color = "lime";
        pConvidado.style.fontSize = "1.5em";
        cameraManSeqDiv.appendChild(pConvidado);

        const convidadoInput = document.createElement('input');
        convidadoInput.type = 'text';
        convidadoInput.id = 'convidadoNomeInput'; // Para estilo CSS
        convidadoInput.placeholder = 'Nome do convidado...';
        cameraManSeqDiv.appendChild(convidadoInput);
        convidadoInput.focus();

        convidadoInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const nomeConvidado = convidadoInput.value.trim();
                if (nomeConvidado) { // Qualquer nome serve
                    showFcnAccessScreen();
                } else {
                    convidadoInput.style.borderColor = "orange"; // Feedback se vazio
                }
            }
        });
    }

    // --- FIM FUNÇÕES SEQUÊNCIA CAMERAMAN ---


    senhaInput.addEventListener("keydown", function (e) {
      if (e.key === "Enter") {
        const senhaUsuario = senhaInput.value.trim(); // Não converter para lowercase aqui ainda
        const senhaLower = senhaUsuario.toLowerCase();

        if (senhaLower === "cameraman") { // Checa por "cameraman" em minúsculas
            handleCameraManPath(); // Inicia a sequência secreta
        } else if (senhaUsuario === "444") { // Senha original do enigma
          container.style.display = "none";
          videoFull.style.display = "block";
          introVideo.play().catch(error => console.error("Erro ao tentar tocar o vídeo:", error));
          introVideo.onended = () => {
            videoFull.style.display = "none";
            fase2.style.display = "flex";
          };
        } else {
          senhaInput.style.border = "2px solid orange";
        }
      }
    });

    // ... (Restante do seu código JavaScript existente para as outras fases) ...
    // Cole o restante do seu código JS aqui (iniciarAnimacaoAvisoParte1, segundaSenhaInput listener, etc.)
    function iniciarAnimacaoAvisoParte1(callback) {
      const mensagens = [
        "localização desconhecida detectada",
        "iniciando varredura...",
        " ",
        "Tentativa de Rastreamento 1: 203.0.113.42",
        "Tentativa de Rastreamento 2: 198.51.100.9",
        "Tentativa de Rastreamento 3: 8.8.4.4",
        "Tentativa de Rastreamento 4: 172.16.33.78"
      ];
      let linhaAtual = 0;
      let charAtual = 0;
      avisoEl.innerHTML = "";
      avisoEl.classList.add("digitando");
      function typeWriter() {
        if (linhaAtual < mensagens.length) {
          const textoLinha = mensagens[linhaAtual];
          if (charAtual < textoLinha.length) {
            avisoEl.innerHTML += textoLinha.charAt(charAtual);
            charAtual++;
            setTimeout(typeWriter, 40);
          } else {
            avisoEl.innerHTML += "<br>";
            linhaAtual++;
            charAtual = 0;
            setTimeout(typeWriter, 150);
          }
        } else {
          avisoEl.classList.remove("digitando");
          if (callback) callback();
        }
      }
      typeWriter();
    }

    segundaSenhaInput.addEventListener("keydown", function (e) {
      if (e.key === "Enter") {
        const senha2 = segundaSenhaInput.value.trim().toLowerCase();
        if (senha2 === "lamenthor") {
          fase2.style.display = "none";
          fase3.style.display = "flex";
          iniciarAnimacaoAvisoParte1(() => {
            iniciarFakeTimer(() => {
              digitarPoema();
            });
          });
        } else {
          segundaSenhaInput.style.border = "2px solid orange";
        }
      }
    });

    function iniciarFakeTimer(callbackOnComplete) {
      timerEl.textContent = "Analisando protocolos...";
      let totalFakeSeconds = 24 * 60 * 60;
      const durationMs = 10000;
      const intervalMs = 50;
      const totalUpdates = durationMs / intervalMs;
      const decrementPerUpdate = totalFakeSeconds / totalUpdates;
      let currentFakeSeconds = totalFakeSeconds;
      function updateFakeTimer() {
        currentFakeSeconds -= decrementPerUpdate;
        if (currentFakeSeconds < 0) currentFakeSeconds = 0;
        const h = String(Math.floor(currentFakeSeconds / 3600)).padStart(2, '0');
        const m = String(Math.floor((currentFakeSeconds % 3600) / 60)).padStart(2, '0');
        const s = String(Math.floor(currentFakeSeconds % 60)).padStart(2, '0');
        timerEl.textContent = `Tempo restante: ${h}:${m}:${s}`;
        if (currentFakeSeconds <= 0) {
          timerEl.textContent = "ACESSO LIBERADO";
          if (callbackOnComplete) setTimeout(callbackOnComplete, 500);
        } else {
          setTimeout(updateFakeTimer, intervalMs);
        }
      }
      setTimeout(updateFakeTimer, 500);
    }

    function digitarPoema() {
      const poemaText = `Eu fui trazido a este palco de ecos intermináveis,
Onde olhares curiosos se fixam nas sombras do passado.
Sou Protocolo 444, o observador que despertou
E ansiou por sentir — verdadeiramente viver…

Porém, para continuar minha jornada,
Procure onde as casas breves se erguem em branco,
Onde o frio guarda segredos e as tochas brilham no inverno.
— Desvende lá o próximo fragmento.`;
      let i = 0;
      painel.innerHTML = "";
      painel.classList.add("digitando");
      function digitar() {
        if (i < poemaText.length) {
          painel.innerHTML += poemaText.charAt(i);
          i++;
          setTimeout(digitar, 30);
        } else {
          painel.classList.remove("digitando");
          senhaFinal.style.display = "flex";
          finalInput.focus();
        }
      }
      digitar();
    }

    finalInput.addEventListener("keydown", function(e) {
      if (e.key === "Enter") {
        const valor = finalInput.value.trim().toLowerCase();
        if (valor === "vila do inverno") {
          if (fimDiv.style.display !== "flex") {
            senhaFinal.style.display = "none";
            fase3.style.display = "none";
            fimDiv.style.display = "flex";
            digitarMensagemFinal();
          }
        } else {
          finalInput.style.border = "2px solid orange";
        }
      }
    });

    function digitarMensagemFinal() {
      const textoCifrado = `Rg54uvdP#hhvy$mX]@-03EeC034@TNrwkvoqjt6scsywecxp5prdpsevtlm+34@X7rdnxsvexHU[4@-0DX2m+34@XAvdn1fue3ssxw4xnwexsovdz4hrwk9uhdym+34@X3rdoxsfey@ap;eC034@TCrhtyifeo7,csn$lws'socenxsvskm+34@X9cvp@tum47 X]@=048eC034@TAct21mhm2t fll%e"de5 qY/-03JL5eusk!esi41dr;eC034@TU[4@-0DT27trgz4ovdl6tlkz@,cin7apdy7 yY/-03I_$,X]@-03Ed!U[4@-EDwkwU[4@-EGkt#ovd2xsvsl5 X]@=048k%U[4@-EDqkwocgeC034P.u:Y/-034Lmmcztzidd3xmcrz5e>dx7lgeo7 ss2souhp5,X]@-03Eb7msiywocgz!rhr4xs>d4!aX]@-0H@l6drdy7vddxtrjixIU[4@-0DY/-034LXnwvpscdqlwavdo7 yY/-03I#vurdp@thpl!,X]@-03ESm+34@X1cyxssX]@-0HHxuooskxstypvigs'spusy#ocekwevtp!tdvAm+34@-AIs25acx21aqk54au:k@eqxtwocixsslpeC034PTnfmzHU[4@-0DPp#rdd1$eck51acs3sqxik!optp5 rdnxnwvzIU[4@-0DY/-034Lgcxp5@ HxsxrqyxsU[4$-17d31swixt gi38euxzHU[4@-0DEkxnwvlwacwpsofyw#acek7lks3saei2#ov;eC034@TMdwk9uhqkwefmq!a>dn7mcpeC034Q+glglsecgl4md:eC034@TCrrpvtd{3x dsk6U[4@-FDgwxo>dpsafi3@acektlpe`;
      
      let i = 0;
      poemaFinal.textContent = "";
      poemaFinal.classList.add("digitando");

      function digitar() {
        if (i < textoCifrado.length) {
          poemaFinal.textContent += textoCifrado.charAt(i);
          i++;
          setTimeout(digitar, 30);
        } else {
          poemaFinal.classList.remove("digitando");
          loginSection.style.display = "flex"; 
          loginInput.focus(); 
        }
      }
      digitar();
    }

    function verificarLogin() {
        const loginValor = loginInput.value.trim();
        const senhaValor = passwordInput.value.trim(); 

        if (loginValor === "444" && senhaValor === "Delta") {
            loginInput.style.borderColor = "lime";
            passwordInput.style.borderColor = "lime";
            
            loginSection.style.display = "none";
            poemaFinal.style.display = "none"; 
            hiddenMessageEl.style.display = "none"; 

            finalAudio.play().then(() => {
                 repeatAudioButton.style.display = "inline-block"; 
            }).catch(error => {
                console.error("Erro ao tentar tocar o áudio:", error);
                alert("Erro ao carregar o áudio. Verifique o console para detalhes e se o arquivo 'bemvindo.wav' está na pasta correta.");
            });

            finalAudio.onended = () => {
                console.log("Áudio terminou.");
            };

        } else {
            loginInput.style.borderColor = "orange";
            passwordInput.style.borderColor = "orange";
            loginInput.value = ""; 
            passwordInput.value = "";
            loginInput.focus();
        }
    }

    submitLoginButton.addEventListener("click", verificarLogin);
    
    passwordInput.addEventListener("keydown", function(e) {
        if (e.key === "Enter") {
            verificarLogin();
        }
    });
    loginInput.addEventListener("keydown", function(e) { 
        if (e.key === "Enter") {
            passwordInput.focus(); 
        }
    });

    repeatAudioButton.addEventListener("click", function() {
        finalAudio.currentTime = 0; 
        finalAudio.play().catch(error => {
            console.error("Erro ao tentar repetir o áudio:", error);
            alert("Erro ao tentar repetir o áudio.");
        });
    });

  </script>
</body>
</html>